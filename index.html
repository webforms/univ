<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>univ - Universal Validator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="nico 0.5.1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link type="image/x-icon" href="/favicon.ico" rel="icon">
    <link rel="stylesheet" href="./static/css/normalize.css" />
    <link rel="stylesheet" href="./static/css/site.css" />
    <link rel="stylesheet" href="./static/css/solarized.css" />
<script>
if (!location.port) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-50522089-2', 'auto');
  ga('send', 'pageview');
}
</script>
<script src="./static/js/sea.js?nowrap"></script>

<script>
  seajs.config({
    base: "./",
    alias: {"events":"events/1.0.1/events.js","promise":"promise/6.0.0/index.js","expect.js":"expect.js/0.3.1/index.js"}
  });
</script>
    <!--[if lt IE 9]>
    <script src="./static/js/html5shiv.js"></script>
    <![endif]-->
  </head>
  <body class="spmjs">
    <div class="body-wrapper">
      <aside class="sidebar-wrapper">
      <h1>
          <a href="./">Univ</a>
      </h1>
      <p class="sidebar-version">Version: <a href="http://spmjs.io/package/univ" title="">0.2.1</a></p>
        <p class="sidebar-description" data-keyword="Validator">Universal Validator.</p>
        <a class="sidebar-source" href="http://github.com/webforms/univ" target="_blank">View the Project</a>
        <ul class="sidebar-navigation" role="navigation">
          <li><a href="./">Doc</a></li>
          <li><a href="examples/">Demo</a></li>
          <li><a href="history.html">History</a></li>
          <li><a class="test-link" href="tests/runner.html" target="_blank">Test</a></li>
          <li><a class="issue-link" href="http://github.com/webforms/univ/issues" target="_blank">Issues</a></li>
        </ul>
        

        <div class="qrcode-wrapper">
          <i class="icon">
            <div class="icon-qrcode">
              <svg width="1024" height="1024" viewBox="0 0 1024 1024">
                <g class="transform-group">
                  <g transform="translate(0, 18) scale(1, -1) scale(0.024, 0.024)">
                    <path d="M116.8 792.062v0 0zM334.523 138.877v-72.569h-72.569v72.569h72.569zM334.523 574.339v-72.569h-72.569v72.569h72.569zM769.984 574.339v-72.569h-72.569v72.569h72.569zM189.369-5.705h217.723v217.167h-217.723v-217.167zM189.369 429.185h217.723v217.723h-217.723v-217.723zM624.831 429.185h217.723v217.723h-217.723v-217.723zM479.677 284.031v-362.877h-362.877v362.877h362.877zM769.984-6.277v-72.569h-72.569v72.569h72.569zM915.138-6.277v-72.569h-72.569v72.569h72.569zM915.138 284.031v-217.723h-217.723v72.569h-72.569v-217.723h-72.569v362.877h217.723v-72.569h72.569v72.569h72.569zM479.677 719.493v-362.877h-362.877v362.877h362.877zM915.138 719.493v-362.877h-362.877v362.877h362.877z" fill="#555"></path>
                  </g>
                </g>
              </svg>
            </div>
            <div class="qrcode" id="qrcode"></div>
          </i>
        </div>
        <div class="footer-wrapper"><a target="_blank" href="http://spmjs.io">spmjs.io</a> /
<a target="_blank" href="https://github.com/spmjs/spm">spm</a> /
<a target="_blank" href="http://seajs.org">sea.js</a> /
<a target="_blank" href="http://lab.lepture.com/nico/">nico</a>
        </div>
      </aside>
      <div class="content-wrapper">
        
<article class="hentry">
  <h1 class="entry-title">Universal Validator</h1>
  <div class="entry-content">
    <p><a href="https://www.npmjs.com/package/univ"><img src="https://badge.fury.io/js/univ.png" alt="NPM version"></a>
<a href="http://spmjs.io/package/univ"><img src="http://spmjs.io/badge/univ" alt="spm package"></a>
<a href="https://travis-ci.org/webforms/univ"><img src="https://secure.travis-ci.org/webforms/univ.png?branch=master" alt="Build Status"></a>
<a href="https://coveralls.io/r/webforms/univ"><img src="https://coveralls.io/repos/webforms/univ/badge.png?branch=master" alt="Coverage Status"></a></p>
<p>Universal Validator.</p>
<hr>
<h2 id="install">Install<a href="#install" class="anchor">¶</a></h2><p>via spm:</p>
<pre>$ spm install univ</pre><p>via npm:</p>
<pre>$ npm install univ</pre><h2 id="usage">Usage<a href="#usage" class="anchor">¶</a></h2><div class="highlight"><pre><code class="javascript"><span class="keyword">var</span> Validator = require(<span class="string">'univ'</span>);

<span class="keyword">var</span> rules = {
  <span class="string">"username"</span>: {
    type: <span class="string">"email"</span>,
    required: <span class="literal">true</span>,

    <span class="comment">// @param {String} value.</span>
    custom: <span class="function"><span class="keyword">function</span><span class="params">(value)</span>{</span>
      <span class="keyword">return</span> <span class="keyword">new</span> Promise(<span class="function"><span class="keyword">function</span><span class="params">(resolve, reject)</span>{</span>

        $.ajax({
          url: <span class="string">"/check-username-available"</span>,
          data: <span class="string">"username="</span>+value,
          success: <span class="function"><span class="keyword">function</span><span class="params">(data)</span>{</span>
            <span class="keyword">if</span>(data.state === <span class="string">"ok"</span> &amp;&amp; data.available = <span class="string">"yes"</span>){
              resolve(<span class="literal">true</span>);
            }<span class="keyword">else</span>{
              resolve(<span class="literal">false</span>);
            }
          },
          error: <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
            reject(<span class="literal">false</span>);
          }
        });

      })

    }
  },
  <span class="string">"password"</span>: {
    type: <span class="string">"password"</span>,
    required: <span class="literal">true</span>,
    minlength: <span class="number">6</span>,
    maxlength: <span class="number">30</span>
  },
  <span class="string">"re-password"</span>: {
    type: <span class="string">"password"</span>,
    required: <span class="literal">true</span>,
    minlength: <span class="number">6</span>,
    maxlength: <span class="number">30</span>,
    custom: <span class="function"><span class="keyword">function</span><span class="params">(value)</span>{</span>
      <span class="keyword">return</span> value === <span class="keyword">this</span>.data(<span class="string">"password"</span>);
    }
  }
};

<span class="keyword">var</span> validator = <span class="keyword">new</span> Validator(rules);
<span class="keyword">var</span> result = <span class="keyword">yield</span> validator.validate({
  <span class="string">"username"</span>: <span class="string">"hotoo@email.address"</span>,
  <span class="string">"password"</span>: <span class="string">"PassWord"</span>,
  <span class="string">"checkbox"</span>: [<span class="string">"check-0"</span>, <span class="string">"check-1"</span>]
});</code></pre></div><h2 id="api">API<a href="#api" class="anchor">¶</a></h2><h3 id="validator-ruler">Validator(ruler)<a href="#validator-ruler" class="anchor">¶</a></h3><p>constructor, new a validator by rulers.</p>
<div class="highlight"><pre><code class="javascript">{
  <span class="comment">// rule name.</span>
  <span class="string">"name"</span>: {
    type: {TypeEnum(
      text,password, search,textarea,
      radio,checkbox,
      select-one,select-multiple,
      number,range, email,url,tel,color,
      date,week,month,time,datetime,datetime-local,
      file,
      submit,button,image,
      hidden
    )},
    required: {Boolean},
    max: {Number},
    min: {Number},
    maxlength: {Number},
    minlength: {Number},
    pattern: {RegExp},
    multiple: {Boolean},
    step: {Number},
    accept: {Array&lt;String&gt;},
    custom: {Function}
  },
  <span class="string">"other-name"</span>: {
    <span class="comment">// ...</span>
  },
  <span class="comment">// ...</span>
}</code></pre></div><h3 id="univ-rule-name-rule">Univ.rule(name, rule)<a href="#univ-rule-name-rule" class="anchor">¶</a></h3><p>Set or get a custom rule.</p>
<div class="highlight"><pre><code class="javascript">validator.rule(<span class="string">"isBankCard"</span>, <span class="function"><span class="keyword">function</span><span class="params">(values)</span>{</span>
  <span class="keyword">return</span> <span class="literal">true</span>;
});</code></pre></div><h3 id="univ-validate-data">univ.validate(data)<a href="#univ-validate-data" class="anchor">¶</a></h3><p>data:</p>
<div class="highlight"><pre><code class="javascript">univ.validate(
  {
    <span class="string">"name"</span>: <span class="string">"value"</span>,
    <span class="string">"other-name"</span>: [<span class="string">"item-1"</span>, <span class="string">"item-2"</span>],
    <span class="comment">// ...</span>
  }
);</code></pre></div><h2 id="events">Events<a href="#events" class="anchor">¶</a></h2><h3 id="valid">valid<a href="#valid" class="anchor">¶</a></h3><p>单个数据项通过校验，数据合法有效。</p>
<div class="highlight"><pre><code class="javascript">validator.on(<span class="string">"valid"</span>, <span class="function"><span class="keyword">function</span><span class="params">(name, value, validity)</span>{</span>
  console.log(<span class="string">"Field [name="</span> + name + <span class="string">"] Passed."</span>);
});</code></pre></div><h3 id="invalid">invalid<a href="#invalid" class="anchor">¶</a></h3><p>单个数据项未通过校验，数据无效、不合法。</p>
<div class="highlight"><pre><code class="javascript">validator.on(<span class="string">"valid"</span>, <span class="function"><span class="keyword">function</span><span class="params">(name, value, validity)</span>{</span>
  console.log(<span class="string">"Field [name="</span> + name + <span class="string">"] Failed."</span>);
});</code></pre></div><h3 id="complete">complete<a href="#complete" class="anchor">¶</a></h3><p>所有数据校验完成。数据是否全部通过校验，则视事件处理函数的对应参数。</p>
<div class="highlight"><pre><code class="javascript"><span class="comment">// @param {Boolean} certified.</span>
validator.on(<span class="string">"complete"</span>, <span class="function"><span class="keyword">function</span><span class="params">(certified)</span>{</span>
  console.log(<span class="string">"Form validation"</span>, certified ? <span class="string">"Passed"</span> : <span class="string">"Failed"</span>);
});</code></pre></div><h3 id="error">error<a href="#error" class="anchor">¶</a></h3><p>校验过程中出现异常，则抛出 <code>error</code> 事件。</p>
<div class="highlight"><pre><code class="javascript"><span class="comment">// @param {Error} error</span>
validator.on(<span class="string">"error"</span>, <span class="function"><span class="keyword">function</span><span class="params">(error)</span>{</span>
});</code></pre></div>
  </div>
</article>

      </div>
      
    </div>
  </body>
  <script src="./static/js/nprogress.js?nowrap"></script>
  <script>
  (function() {
    NProgress.start();
    window.onload = NProgress.done;
    var ready = function(fn) {
      var doc = document;
      if(doc.addEventListener) {
        doc.addEventListener('DOMContentLoaded', fn, false);
      } else {
        doc.attachEvent('onreadystatechange', fn);
      }
    };
    ready(function() {
      NProgress.inc(0.6);
      seajs.use("./static/js/arale-qrcode.js?nowrap", function(QRCode) {
        var url = location.href;
        if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
          url = url.replace(location.hostname, '10.15.100.24');
        }
        var el = new QRCode({
          text: url,
          render: 'canvas',
          width: 120,
          height: 120
        });
        document.getElementById('qrcode').appendChild(el);
      });
    }, false);
  })();

  seajs.config({
    paths: {
      jquery: 'http://static.alipayobjects.com/jquery/'
    }
  });
  seajs.use(['jquery/1.7.2/jquery'], function($) {
    $('.highlight').on('click', '.code-toggle', function() {
      var pre = $(this).parents('.highlight')
      if (pre.hasClass('collapse')) {
        pre.removeClass('collapse')
        $(this).text('−')
      } else {
        pre.addClass('collapse')
        $(this).text('+')
      }
      return false
    });

    $('h4 em, h3 em, h3 code, h4 code').parent().addClass('doc-api');

    // 给 iframe 加链接
    $('.nico-iframe').each(function(i, item) {
      var src = $(item).find('iframe').attr('src')
      var html = '<a class="new-window" target="_blank" href="' + src + '">Open</a>'
      $(item).append(html)
    });

    // 给 code 加收起和展开
    $('.highlight').each(function(i, item) {
      var $item = $(item)
      if ($item.height() > 400) {
        $item.append('<a class="code-toggle" href="#">+</a>')
        $item.addClass('collapse')
      }
    });
  });
  </script>
</html>